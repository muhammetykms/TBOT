{% extends "tepe.html" %}

{% block title %}
T-ERP İndikatörler
{% endblock %}

{% load static %}



{% block sayfabasligi %}

{% endblock %}

{% block sagustmap %}
      <li class="breadcrumb-item"><a href="{% url 'home' %}">Genel</a></li>
      <li class="breadcrumb-item">Mumlar</li>

{% endblock %}



{% block content %}

    <h1>Parite ve Interval Listesi</h1>





  <!-- TradingView Embed Widget -->
<div class="card">
  <div class="card-header">
    <div class="row">
        <div class="col-6">    <h3 class="card-title"><b>Devam Eden Üretim Süreçleri</b></h3></div>
        <div class="col-6"><a href="{% url 'mumlar:parite_ekle' %}" class="btn btn-success">Patire ekle</a></div>
    </div>

  </div>
  <!-- /.card-header -->
  <div class="card-body">
        <h1>PariteInterval Listesi</h1>
    {% csrf_token %}
    <table id="example1" class="table table-bordered table-striped">
        <thead>
            <tr>
                <th>Parite</th>
                <th>Interval</th>
                <th>Market</th>
                <th>Onay</th>
            </tr>
        </thead>
        <tbody>
            {% for record in pariteintervalmarkets %}
            <tr>
                <td>{{ record.parite }}</td>
                <td>{{ record.interval }}</td>
                <td>{{ record.market }}</td>
                <td>
                    <div class="form-group">
                        <div class="custom-control custom-switch custom-switch-off-danger custom-switch-on-success">
                            <input 
                                type="checkbox" 
                                class="onay-checkbox custom-control-input update-status"
                                id="customSwitch{{ record.id }}"
                                data-id="{{ record.id }}" 
                                {% if record.onay %}checked{% endif %}
                            >
                            <label 
                                class="custom-control-label" 
                                for="customSwitch{{ record.id }}">
                            </label>
                        </div>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
  </div>
</div>




{% endblock %}


{% block footer %}
<p>My custom footer for this page.</p>

<!-- jQuery -->
<script src="{% static 'plugins/jquery/jquery.min.js' %}"></script>
<!-- Bootstrap 4 -->
<script src="{% static 'plugins/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
<!-- DataTables  & Plugins -->
<script src="{% static 'plugins/datatables/jquery.dataTables.min.js' %}"></script>
<script src="{% static 'plugins/datatables-bs4/js/dataTables.bootstrap4.min.js' %}"></script>
<script src="{% static 'plugins/datatables-responsive/js/dataTables.responsive.min.js' %}"></script>
<script src="{% static 'plugins/datatables-responsive/js/responsive.bootstrap4.min.js' %}"></script>
<script src="{% static 'plugins/datatables-buttons/js/dataTables.buttons.min.js' %}"></script>
<script src="{% static 'plugins/datatables-buttons/js/buttons.bootstrap4.min.js' %}"></script>
<script src="{% static 'plugins/jszip/jszip.min.js' %}"></script>
<script src="{% static 'plugins/pdfmake/pdfmake.min.js' %}"></script>
<script src="{% static 'plugins/pdfmake/vfs_fonts.js' %}"></script>
<script src="{% static 'plugins/datatables-buttons/js/buttons.html5.min.js' %}"></script>
<script src="{% static 'plugins/datatables-buttons/js/buttons.print.min.js' %}"></script>
<script src="{% static 'plugins/datatables-buttons/js/buttons.colVis.min.js' %}"></script>

<script>
$(document).ready(function () {
    $(function () {
        console.log("JavaScript yüklendi ve çalışıyor!");

        $(document).on("change", ".update-status", function () {
            console.log("Checkbox tıklandı!"); // Tıklama olayını izleme
            var checkbox = $(this);
            var pariteintervalId = checkbox.data("id");
            var newStatus = checkbox.prop("checked");

            console.log("ID:", pariteintervalId, "Yeni Durum:", newStatus);

            $.ajax({
                url: "{% url 'mumlar:pariteler_ve_interval' %}",
                type: "POST",
                data: {
                    id: pariteintervalId,
                    onay: newStatus,
                    csrfmiddlewaretoken: $("input[name='csrfmiddlewaretoken']").val()
                },
                success: function (response) {
                    console.log("Başarıyla güncellendi:", response);
                },
                error: function () {
                    console.error("Sunucu hatası!");
                }
            });
        });
    });

});

</script>



<!-- datatable -->
<script>
  $(function () {
    $("#example1").DataTable({
      "responsive": true, "lengthChange": false, "autoWidth": false,
      "buttons": ["copy", "csv", "excel", "pdf", "print", "colvis"],
      "pageLength": 18,
           "order": [
            [0, "asc"],
            [1, "desc"]
        ], // 1. sü
    }).buttons().container().appendTo('#example1_wrapper .col-md-6:eq(0)');

  });
</script>
{% endblock %}
